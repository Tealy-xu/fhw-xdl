<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="Content-Language" content="zh-cn">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>我的订单_个人中心_华为商城</title>
<link rel="shortcut icon" href="__PUBLIC__/Ico/favicon.ico">
<link href="__PUBLIC__/css/person/ec.core.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/lib/layer/2.1/layer.js"></script>
<link href="__PUBLIC__/css/person/main.css" rel="stylesheet" type="text/css">


<style>
#list-pager .current{
	border:1px solid #ccc;
	display:inline-block;
	width:7px;
	height:16px;
	font-weight:400;
	text-align:center;
	line-height:16px;
    font-size:12px;
	padding:0 5px;
	background:#D2D2D2;
	margin-left:5px;
	margin-right:5px;
}
#list-pager .num{
    border:1px solid #ccc;
	display:inline-block;
	width:7px;
	height:16px;
	font-weight:400;
	text-align:center;
	line-height:16px;
    font-size:12px;
	padding:0 5px;
	
	margin-left:5px;
	margin-right:5px;

}
#list-pager .prev{
    border:1px solid #ccc;
	display:inline-block;
	width:7px;
	height:16px;
	font-weight:400;
	text-align:center;
	line-height:16px;
    font-size:9px;
	padding-left:3px;
	padding-right:5px;
	
	margin-left:5px;
	margin-right:5px;
}

#list-pager .next{
    border:1px solid #ccc;
	display:inline-block;
	width:7px;
	height:16px;
	text-align:center;
	line-height:16px;
    font-size:9px;
	padding-left:3px;
	padding-right:5px;
	
	margin-left:5px;
	margin-right:5px;


}
</style>
</head>



<body>
<include file="Public/pinkheader"/>
<include file="Public/searchheader"/>

<include file="Public/naver"/>





<div class="g">
    <div class="fl u-4-5"><!--栏目 -->
<div class="part-area clearfix">
    <div class="fl">
        <h3 class="myOrders-title"><span>我的订单</span></h3>        
   	 </div>
    </div>

<div class="hr-3"></div>
<!--我的订单 -->
<div class="myOrders-area">
	<div class="myOrders-title-area">
        <div class="h clearfix">
            <div class="fl">
                <div class="h-tab">
                    <ul>
                        
                    </ul>
                </div>
            </div>
        </div>
        <div class="b">
            <table border="0" cellpadding="0" cellspacing="0" id="order-list-head">
                <thead>
                    <tr>
                        <th>订单号</th>
                        <th>送货地址</th>
                        <th class="tr-span-4">实付款<em>/元</em></th>
                        <th class="tr-span-4 operate">订单状态及操作</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    <div class="hr-2"></div>
    <!-------------------以上为订单头部---------------------------------->
    <div id="myOrders-list-content">
        <div class="myOrders-list">
    
    	
    	
    
    	
    	<!--我的订单-订单-套餐 -->
	 <volist name="list" id="vo">
    	<div class="myOrders-pro-area">
        	<div class="h clearfix">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tbody>
                        <tr>
                            <td class="tal">
                            	<input type="hidden" id="order_id" value="{$vo.id}">
                            	订单编号：<a href="{:U('OrderCenter/show')}?oid={$vo.id}&state={$vo.state}" title="{$vo.order_no}" onclick="orderdetail_show({$vo.id})">{$vo.ordernum}</a>
                            	&nbsp;&nbsp;&nbsp;&nbsp;
          
								
                            </td>
                            <td>
                            	生成时间：{$vo.addtime|date='Y-m-d H:i:s',###}
								&nbsp;&nbsp;&nbsp;&nbsp;
                            </td>
                            <td class="tr-span-4">
								<em>
								    <if condition="$vo['state'] eq '0'">未付款</if>
								     <if condition="$vo['state'] eq '1'">已付款</if>
								      <if condition="$vo['state'] eq '2'">正在发货中</if>
								      <if condition="$vo['state'] eq '3'">等待卖家确认交易</if>
								       <if condition="$vo['state'] eq '4'">交易完成</if>
								</em>
							</td>
                        </tr>
                	</tbody>
                </table>  
            </div>
            <div class="b">
            	<table border="0" cellpadding="0" cellspacing="0">
                    <tbody>

						
						
                        <!-- 组合套餐列表 -->

						<!-- 普通商品列表 -->
					
                         <tr>
                         <td><img src="__PUBLIC__/Images/Orderboli.png"></td>
                            <!-- <td class="tal">
                                <div class="pro-area clearfix">
                                    <p class="p-img">
                                    	<a title="{$vo.goods.name}" href="{:U('Product/index',array('g'=>$vo['goods']['id']))}" target="_blank">
                                    	<img alt="{$vo['goods']['name']}" src="__PUBLIC__{$vo.goods.image1}">
                                        
                                    	</a>
                                    </p>
                                    <p class="p-name">
                                    	<a title="{$vo.goods.name}" target="_blank" href="{:U('Product/index',array('g'=>$vo['goods']['id']))}">{$vo.goods.name}</a>
                                    </p>
                                    
                                </div>
                            </td> -->

                            <td class="tr-span-12">{$vo.areadetail}</td>                       


								<td rowspan="2" class="tr-span-4">
									<p>¥{$vo.totalprice}</p>
								</td>
                            
							
								<td rowspan="2" class="tr-span-4 operate">
									  <if condition="$vo['state'] eq '0'">
								   <a class="pay" href="javascript:;">去付款</a>
								   <input type="hidden" name="oid" value="{$vo['id']}">
								   <script>
								   		$('.pay').click(function(){
								   			var oid = $('input[name=oid]').prop('value');
								   			layer.confirm('确定要付款吗',{
												time:0,
												btn: ['确定', '取消'],
												shade: 0,
												yes: function(index){
													$.post(
														"__CONTROLLER__/payment",
														{'oid':oid},
														function(status){
															// alert(status);
															if(status == 1){
																// layer.close(index);
																layer.msg('支付成功', {icon: 6});
																setTimeout(function(){
																	window.location.reload();
																},1500);
															}else{
																layer.alert('余额不足，请尽快充值');
															}
														}
													);
												}
											});
								   		});
								   </script>
								        <elseif condition="$vo['state'] eq '1'" />
										    等待发货
										<elseif condition="$vo['state'] eq '2'" />
										
										   <input type="hidden" value="{$vo.id}"/>
									       <a href="javascript:void(0);" class="recOreder">确认收货</a>
										<elseif condition="$vo['state'] eq '3'" />
											已签收
										<elseif condition="$vo['state'] eq '4'"  />
										   （亲，点击订单号加个评价把）
										</if>
										
								</td>
							
							

                        </tr>
                       
                        
                        
                        
                        
					   <!-- 普通商品列表 end -->
                    </tbody>
                </table>
            </div>
        </div>
		 </volist>
		 
		
		
		
	
        </div>
        
    </div>
<script type="text/javascript">
   $(function(){
         //收货的ajax处理
        $(".recOreder").click(function(){
		    var order_id=$(this).prev('input').val();
		    console.log(order_id);
			var value=confirm("你确定要收货吗?");
			
			if(value){
			     $.ajax({
				     url:"{:U('OrderCenter/receOrder')}",
					 type:'post',
					 data:{
					     'oid':order_id,
					 },
					 success:function(responseText,status,xhr){
						      if(responseText==1){
							     window.location.reload();
								 alert("收货成功!");
							  }else{
							     alert("收货失败");						  
					 }
					}
		});
   }
});
});
//显示订单详情
// function orderdetail_show(id){
// 	layer.open({
// 		type:2,
// 		title:false,
// 		area:['790px', '380px'],
// 		maxmin: true,
// 		scrollbar: false,
// 		moveOut: true,
// 		content:"{:U('OrderCenter/show',array('oid'=>id))}",
// 		success:function(id){
// 	}
// })
// }

</script>
    <div class="hr-5"></div>
    <!--分页-->
    <div class="pager" id="list-pager">
	   <ul>
	       {$show}
		</ul>
	 </div>
    
</div>
<input type="hidden" id="colid" value="0">




</div>
	
</div>
<div class="hr-60"></div>
<script type="text/javascript" src="__PUBLIC__/lib/layer/2.1/layer.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
</body></html>